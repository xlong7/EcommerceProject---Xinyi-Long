<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomePage</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        body {
          margin: 0;
          font-family: Arial, Helvetica, sans-serif;
        }
        
        .topnav {
          overflow: hidden;
          background-color: rgb(70, 82, 82);
        }
        
        .topnav a {
          float: left;
          color: #f2f2f2;
          text-align: center;
          padding: 14px 16px;
          text-decoration: none;
          font-size: 17px;
        }
        
        .topnav a:hover {
          background-color: #ddd;
          color: black;
        }
        
        .topnav a.active {
          background-color: #030605;
          color: white;
        }
        .brand1{
          display:none
        }
        .brand2{
          display:none
        }
        img{
          width:50%
        }
        #status{
          float: right;
        }
      </style>
  </head>
  <body>
      {{!-- The navigation bar section --}}
      <div class="topnav">
        
        {{#if admin}}
           <div class="topnav">
             <a id="checkReq" href="/homepage">Checkout Requests</a>
              <a id="userOrder" href="/order_history">User Order History</a>
            <div>
              <a id="logout" href="" onclick=clearCookies()>Logout</a>
            </div>
        {{else}}
        {{!-- {{#if loggedIn}} --}}
            <a id="homepage" href="/homepage">Home</a>
          {{!-- {{else}} --}}
            {{!-- <a id="homepage" href="/">Home</a> --}}
          {{!-- {{/if}} --}}
          <a id="cart" href="/cartpage">Cart</a>
          <a id="orders" href="/myorder">My Orders</a>
          <div>
          {{#if loggedIn}}
            <a id="logout" href="" onclick=clearCookies() >Logout</a>
            <a id="{{username}}" style="display:hidden"></a>
          {{else}}
            <a id="register" href="/register">Sign up</a>
            <a id="login" href="/login">Login</a>
          {{/if}}
        {{/if}}
        </div>
      </div>
    <div style="padding-left:16px"> </div>
    {{!-- Start of the admin page --}}
    {{#if admin}}
        {{#each orders}}
          <ul class="orderstatus">
            <li id="order_id">Order Number: {{_id}}</li>
            <li>Username: {{username}}</li>
            <form>
               <select name="status" id="status" class="{{_id}}">
                <option value="pending">Pending</option>
                <option value="accepted">Accept</option>
                <option value="rejected">Reject</option>
                </select>
            
            <li>Order Time:{{time}}</li>
            <input type="Button" class="approve" id="{{_id}}" value="approve" />
            </form>
            {{!-- Access the admin page --}}
            <script>
            $(document).ready(function () {
                    $('#{{_id}}').on("click", function () {
                        $.ajax({
                          url: "/admin_checkout",
                          type: "POST",
                          contentType: "application/json; charset=utf-8",
                          data: JSON.stringify({
                            order_id: $('#{{_id}}').attr('id'),
                            approval:$('.{{_id}} option:selected').val()
                          }),
                          success: function (res) {
                            alert('Approved successfully')
                            window.location.reload();
                          },
                          error: function (e) {
                            window.location.reload();
                          }   
                        });
                  });
                });
          </script>
          </ul>       
          <hr> 
        {{/each}}
        {{#each accepted}}
          <ul class="orderstatus">
            <li id="order_id">Order Number: {{_id}}</li>
            <li>Username: {{username}}</li>
            <li>Status: Accepted</li>
            
            <li>Order Time:{{time}}</li>
            </ul> 
            <hr>
        {{/each}}
        {{#each rejected}}
          <ul class="orderstatus">
            <li id="order_id">Order Number: {{_id}}</li>
            <li>Username: {{username}}</li>
            <li>Status: Rejected</li>
            <li>Order Time:{{time}}</li>
            </ul> 
            <hr>
        {{/each}}

    {{!-- End of the admin Section --}}
    
    {{else}}
    {{!-- Start of the user's homepage --}}
    
    <h2>Collections</h2>
    <p>Brand 1</p>
    <div class="container1">
      <img src="imgs/Brand1/1-1.jpg" id="1-1" class="brand1">
      <img src="imgs/Brand1/1-2.jpg" id="1-2" class="brand1">
      <img src="imgs/Brand1/1-3.jpg" id="1-3" class="brand1">
      <img src="imgs/Brand1/1-4.jpg" id="1-4" class="brand1">
      <img src="imgs/Brand1/1-5.jpg" id="1-5" class="brand1">
      <img src="imgs/Brand1/1-6.jpg" id="1-6" class="brand1">
      <img src="imgs/Brand1/1-7.jpg" id="1-7" class="brand1">
      <img src="imgs/Brand1/1-8.jpg" id="1-8" class="brand1">
      <img src="imgs/Brand1/1-9.jpg" id="1-9" class="brand1">
      <img src="imgs/Brand1/1-10.jpg" id="1-10" class="brand1">
      <button class="left" onclick="plusDivs1(-1)">&#10094;</button>
      <button class="right" onclick="plusDivs1(1)">&#10095;</button>

  </div>
  
  <p>Brand 2</p>
   <div class="container2">
    <img src="imgs/Brand2/2-1.jpg" id="2-1" class="brand2">
    <img src="imgs/Brand2/2-2.jpg" id="2-2" class="brand2">
    <img src="imgs/Brand2/2-3.jpg" id="2-3" class="brand2">
    <img src="imgs/Brand2/2-4.jpg" id="2-4" class="brand2">
    <img src="imgs/Brand2/2-5.jpg" id="2-5" class="brand2">
    <img src="imgs/Brand2/2-6.jpg" id="2-6" class="brand2">
    <img src="imgs/Brand2/2-7.jpg" id="2-7" class="brand2">
    <img src="imgs/Brand2/2-8.jpg" id="2-8" class="brand2">
    <img src="imgs/Brand2/2-9.jpg" id="2-9" class="brand2">
    <img src="imgs/Brand2/2-10.jpg" id="2-10" class="brand2">
    <button class="left" onclick="plusDivs2(-1)">&#10094;</button>
    <button class="right" onclick="plusDivs2(1)">&#10095;</button>
  </div>
  
  <div style="padding-bottom:16px"></div>
  {{/if}}
  {{!-- End of the user's homepage --}}

  {{!-- Script for the slide show of pictures --}}
  <script>
    var slideIndex = 1;
    showDivs1(slideIndex);

    function plusDivs1(n) {
      showDivs1(slideIndex += n);
    }

    function showDivs1(n) {
      var x = document.getElementsByClassName("brand1");
      if (n > x.length) {slideIndex = 1}
      if (n < 1) {slideIndex = x.length} ;
      for (let i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      x[slideIndex-1].style.display = "block";
    }


    var slideIndex = 1;
    showDivs2(slideIndex);

    function plusDivs2(n) {
      showDivs2(slideIndex += n);
    }

    function showDivs2(n) {
      var x = document.getElementsByClassName("brand2");
      if (n > x.length) {slideIndex = 1}
      if (n < 1) {slideIndex = x.length} ;
      for (let i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      x[slideIndex-1].style.display = "block";
    }
  </script>
  
  {{!-- Method for thumbnails --}}
  <script>
    const host = "http://localhost:3000";
      $(document).ready(function () {
        for (let j = 1; j <=2;j++){
          var ids = '#'+j + '-'
          for (let i = 1; i <= 10; i++){
              $(ids+i).on("click", function () {
                if($('#logout').length > 0){
                  $.ajax({
                    url: "/productpage/1-1",
                    type: "POST",
                    data: JSON.stringify({
                      img_id: $(this).attr('id'),
                    }),
                    contentType: "application/json; charset=utf-8",
                    success: function (res) {
                        window.location = 'productpage'
                    },
                    error: function (e) {
                      window.location.reload();
                    }   
                  });
                } else{
                  $.ajax({
                    url: "/productpage/1-1",
                    type: "POST",
                    data: JSON.stringify({
                      img_id: $(this).attr('id'),
                      loggedIn: false
                    }),
                    contentType: "application/json; charset=utf-8",
                    success: function (res) {
                      window.location = 'productpage'
                    },
                    error: function (e) {
                      window.location.reload();
                    }   
                  });
                }
            });
          }
        }
      });
    
  </script>
  <script>
      function clearCookies(){
        document.cookie.split(";").forEach(function(c) { document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); });
      }
    </script>
  </body>
</html>